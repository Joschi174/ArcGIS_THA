{
  "version": 3,
  "sources": ["../../@arcgis/core/webdoc/support/saveUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{result as r}from\"../../core/asyncUtils.js\";import e from\"../../core/Error.js\";import{eachAlways as o,throwIfAborted as t}from\"../../core/promiseUtils.js\";import{generateUUID as s}from\"../../core/uuid.js\";import{getSiblingOfSameTypeI as c}from\"../../portal/support/resourceUtils.js\";async function p(r,p,u){if(!p||!p.resources)return;const h=p.portalItem===r.portalItem?new Set(r.paths):new Set;r.paths.length=0,r.portalItem=p.portalItem;const i=new Set(p.resources.toKeep.map((r=>r.resource.path))),m=new Set,f=[];i.forEach((e=>{h.delete(e),r.paths.push(e)}));for(const e of p.resources.toUpdate)if(h.delete(e.resource.path),i.has(e.resource.path)||m.has(e.resource.path)){const{resource:o,content:t,finish:p,error:n}=e,h=c(o,s());r.paths.push(h.path),f.push(a({resource:h,content:t,compress:e.compress,finish:p,error:n},u))}else r.paths.push(e.resource.path),f.push(n(e,u)),m.add(e.resource.path);for(const e of p.resources.toAdd)f.push(a(e,u)),r.paths.push(e.resource.path);if(h.forEach((r=>{if(p.portalItem){const e=p.portalItem.resourceFromPath(r);f.push(e.portalItem.removeResource(e).catch((()=>{})))}})),0===f.length)return;const l=await o(f);t(u);const d=l.filter((r=>\"error\"in r)).map((r=>r.error));if(d.length>0)throw new e(\"save:resources\",\"Failed to save one or more resources\",{errors:d})}async function a(e,o){const t={...null!=o?o:{},compress:e.compress},s=await r(e.resource.portalItem.addResource(e.resource,e.content,t));if(!0!==s.ok)throw e.error?.(s.error),s.error;e.finish?.(e.resource)}async function n(e,o){const t=await r(e.resource.update(e.content,o));if(!0!==t.ok)throw e.error?.(t.error),t.error;e.finish?.(e.resource)}export{p as saveResources};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAIiS,eAAe,EAAE,GAAEA,IAAE,GAAE;AAAC,MAAG,CAACA,MAAG,CAACA,GAAE;AAAU;AAAO,QAAM,IAAEA,GAAE,eAAa,EAAE,aAAW,IAAI,IAAI,EAAE,KAAK,IAAE,oBAAI;AAAI,IAAE,MAAM,SAAO,GAAE,EAAE,aAAWA,GAAE;AAAW,QAAM,IAAE,IAAI,IAAIA,GAAE,UAAU,OAAO,IAAK,CAAAC,OAAGA,GAAE,SAAS,IAAK,CAAC,GAAEC,KAAE,oBAAI,OAAI,IAAE,CAAC;AAAE,IAAE,QAAS,OAAG;AAAC,MAAE,OAAO,CAAC,GAAE,EAAE,MAAM,KAAK,CAAC;AAAA,EAAC,CAAE;AAAE,aAAU,KAAKF,GAAE,UAAU;AAAS,QAAG,EAAE,OAAO,EAAE,SAAS,IAAI,GAAE,EAAE,IAAI,EAAE,SAAS,IAAI,KAAGE,GAAE,IAAI,EAAE,SAAS,IAAI,GAAE;AAAC,YAAK,EAAC,UAAS,GAAE,SAAQ,GAAE,QAAOF,IAAE,OAAMG,GAAC,IAAE,GAAEC,KAAE,EAAE,GAAE,EAAE,CAAC;AAAE,QAAE,MAAM,KAAKA,GAAE,IAAI,GAAE,EAAE,KAAK,EAAE,EAAC,UAASA,IAAE,SAAQ,GAAE,UAAS,EAAE,UAAS,QAAOJ,IAAE,OAAMG,GAAC,GAAE,CAAC,CAAC;AAAA,IAAC;AAAM,QAAE,MAAM,KAAK,EAAE,SAAS,IAAI,GAAE,EAAE,KAAKA,GAAE,GAAE,CAAC,CAAC,GAAED,GAAE,IAAI,EAAE,SAAS,IAAI;AAAE,aAAU,KAAKF,GAAE,UAAU;AAAM,MAAE,KAAK,EAAE,GAAE,CAAC,CAAC,GAAE,EAAE,MAAM,KAAK,EAAE,SAAS,IAAI;AAAE,MAAG,EAAE,QAAS,CAAAC,OAAG;AAAC,QAAGD,GAAE,YAAW;AAAC,YAAM,IAAEA,GAAE,WAAW,iBAAiBC,EAAC;AAAE,QAAE,KAAK,EAAE,WAAW,eAAe,CAAC,EAAE,MAAO,MAAI;AAAA,MAAC,CAAE,CAAC;AAAA,IAAC;AAAA,EAAC,CAAE,GAAE,MAAI,EAAE;AAAO;AAAO,QAAM,IAAE,MAAM,EAAE,CAAC;AAAE,EAAAI,GAAE,CAAC;AAAE,QAAM,IAAE,EAAE,OAAQ,CAAAJ,OAAG,WAAUA,EAAE,EAAE,IAAK,CAAAA,OAAGA,GAAE,KAAM;AAAE,MAAG,EAAE,SAAO;AAAE,UAAM,IAAI,EAAE,kBAAiB,wCAAuC,EAAC,QAAO,EAAC,CAAC;AAAC;AAAC,eAAe,EAAE,GAAE,GAAE;AAJlzC;AAImzC,QAAM,IAAE,EAAC,GAAG,QAAM,IAAE,IAAE,CAAC,GAAE,UAAS,EAAE,SAAQ,GAAEI,KAAE,MAAM,EAAE,EAAE,SAAS,WAAW,YAAY,EAAE,UAAS,EAAE,SAAQ,CAAC,CAAC;AAAE,MAAG,SAAKA,GAAE;AAAG,WAAM,OAAE,UAAF,2BAAUA,GAAE,QAAOA,GAAE;AAAM,UAAE,WAAF,2BAAW,EAAE;AAAS;AAAC,eAAeF,GAAE,GAAE,GAAE;AAJhgD;AAIigD,QAAM,IAAE,MAAM,EAAE,EAAE,SAAS,OAAO,EAAE,SAAQ,CAAC,CAAC;AAAE,MAAG,SAAK,EAAE;AAAG,WAAM,OAAE,UAAF,2BAAU,EAAE,QAAO,EAAE;AAAM,UAAE,WAAF,2BAAW,EAAE;AAAS;",
  "names": ["p", "r", "m", "n", "h", "s"]
}
