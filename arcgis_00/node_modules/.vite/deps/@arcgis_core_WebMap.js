import {
  g as g2
} from "./chunk-XYPRQK7D.js";
import "./chunk-5NZWHNTA.js";
import "./chunk-VS5PVM6T.js";
import "./chunk-O2ZWDZHR.js";
import "./chunk-5OSJP66H.js";
import "./chunk-7XISENE4.js";
import {
  a as a4,
  n as n2
} from "./chunk-X6JWXYJN.js";
import {
  i as i4
} from "./chunk-T3UXUOZW.js";
import "./chunk-FLVP2XLK.js";
import "./chunk-OCKZY4KB.js";
import "./chunk-7RVJFKSW.js";
import "./chunk-JPSSRLNG.js";
import "./chunk-ZVP2JCAJ.js";
import "./chunk-LRYQNKYC.js";
import "./chunk-PAM4FXDN.js";
import "./chunk-4LMKB4SJ.js";
import "./chunk-2DE2MMH2.js";
import "./chunk-ILU5UH7D.js";
import "./chunk-6ALTXU4U.js";
import "./chunk-BPPSEHTY.js";
import "./chunk-MA4VBNWR.js";
import "./chunk-DTFJFPF7.js";
import "./chunk-ODP6NX3Y.js";
import "./chunk-UIMMV4OY.js";
import "./chunk-QZ4HHFPF.js";
import "./chunk-V56SNWAF.js";
import {
  l as l3
} from "./chunk-LLMRDEQF.js";
import "./chunk-UWP7BCPY.js";
import "./chunk-QMJALO7W.js";
import "./chunk-VRNAR2BU.js";
import "./chunk-IAMROCVA.js";
import "./chunk-7L7U6YJ3.js";
import "./chunk-NOI4I5TT.js";
import "./chunk-TPAPJ5F3.js";
import "./chunk-ENPG4N5M.js";
import "./chunk-D733RJGU.js";
import "./chunk-GVRDPBQU.js";
import "./chunk-YYGN2GO6.js";
import "./chunk-QXLGW66I.js";
import "./chunk-YGH3EEG5.js";
import "./chunk-H7EOZY7L.js";
import "./chunk-LKYCF7AI.js";
import "./chunk-DDZ6WPWX.js";
import "./chunk-ZVOARKLE.js";
import "./chunk-BY57CSP7.js";
import "./chunk-52ZYWMNY.js";
import "./chunk-FHYNSVC4.js";
import "./chunk-4HDCOJ24.js";
import "./chunk-VY2MIGMV.js";
import "./chunk-5BKFA3IG.js";
import "./chunk-R5EWWIOD.js";
import "./chunk-52L3OT7H.js";
import "./chunk-NHDVBH5V.js";
import {
  r as r2
} from "./chunk-WLU7KKOI.js";
import "./chunk-BA7WNJMF.js";
import "./chunk-ZZQVVHF7.js";
import "./chunk-SCOBW7KR.js";
import "./chunk-AHAGGZUI.js";
import "./chunk-JHVDJNJ7.js";
import "./chunk-M52YOZDN.js";
import "./chunk-P5CFKMGO.js";
import "./chunk-2EHBSKAM.js";
import "./chunk-HVBIBP5P.js";
import "./chunk-VLY2K2HC.js";
import "./chunk-AVOTXTN2.js";
import {
  O,
  S as S2
} from "./chunk-4FGKBJP7.js";
import "./chunk-LALFHQE3.js";
import "./chunk-IVCYO56U.js";
import "./chunk-JGFWZDK3.js";
import {
  i as i3,
  l as l2,
  s as s4,
  u
} from "./chunk-IN5QJ5F4.js";
import "./chunk-C4I3X4RM.js";
import {
  i as i2
} from "./chunk-GVMBTEIW.js";
import {
  I,
  R as R3,
  h,
  j as j4,
  m as m3
} from "./chunk-EW6IOKCM.js";
import "./chunk-E3Y62DQE.js";
import "./chunk-5IXGL4JZ.js";
import "./chunk-HKDZF6LN.js";
import "./chunk-XR4HIGQP.js";
import "./chunk-BNNFX45U.js";
import "./chunk-U4IWFNWD.js";
import "./chunk-6L4U2AW6.js";
import "./chunk-LCWGEIX7.js";
import "./chunk-RFIIU6XF.js";
import "./chunk-DGADM4KQ.js";
import "./chunk-4CZO65BK.js";
import "./chunk-7C7EF3FD.js";
import "./chunk-PQOGMOZ7.js";
import "./chunk-XMS7FYO7.js";
import "./chunk-HOGRNOD4.js";
import "./chunk-NZY6MEON.js";
import {
  b
} from "./chunk-D76KSV7G.js";
import "./chunk-LWBXWNAZ.js";
import {
  f as f2
} from "./chunk-DVJSRET7.js";
import {
  t
} from "./chunk-2H7DV6BT.js";
import "./chunk-CSKEV5FZ.js";
import "./chunk-Z74XNIJ3.js";
import "./chunk-GRS3EHGG.js";
import "./chunk-Y2CLYMXQ.js";
import "./chunk-EIE3W25Z.js";
import "./chunk-TNYMHVJ4.js";
import "./chunk-OZXJDVTE.js";
import {
  g,
  p as p2
} from "./chunk-Z6HMRH7V.js";
import "./chunk-JZBA2N4X.js";
import "./chunk-4W4V5TBI.js";
import "./chunk-HABV4VZ2.js";
import "./chunk-2D2437VM.js";
import "./chunk-YIIAB4WA.js";
import "./chunk-KTSEQWMB.js";
import {
  o as o3
} from "./chunk-FUHI6TR6.js";
import {
  x
} from "./chunk-FVYUULND.js";
import {
  j as j3
} from "./chunk-BRRN7CRU.js";
import {
  _
} from "./chunk-TLIPFBCN.js";
import "./chunk-7KTXAH5E.js";
import "./chunk-WYE6B4VU.js";
import {
  f as f3
} from "./chunk-WPNWSQW7.js";
import {
  l as l4
} from "./chunk-RHW56URE.js";
import "./chunk-5XLKQQPP.js";
import "./chunk-JUHOAKXP.js";
import "./chunk-X5ASTC4J.js";
import {
  i
} from "./chunk-3OL5L3LC.js";
import {
  c
} from "./chunk-H7C32RFW.js";
import {
  V
} from "./chunk-RNYFZDNI.js";
import "./chunk-FBG4WSP5.js";
import {
  n
} from "./chunk-G3X4SV7G.js";
import "./chunk-AJM6LB5B.js";
import "./chunk-G4LADD2B.js";
import {
  p
} from "./chunk-HLTEFNTE.js";
import "./chunk-CO3TM5QL.js";
import "./chunk-FARQZCLL.js";
import "./chunk-MOPR7RFH.js";
import "./chunk-KW3ZNPTA.js";
import "./chunk-TJB4CGOM.js";
import "./chunk-E5XSQEGK.js";
import {
  R as R2,
  d as d2
} from "./chunk-MZXYP6SL.js";
import {
  S2 as S,
  f,
  r2 as r
} from "./chunk-4X5MDDUC.js";
import {
  o as o2
} from "./chunk-UURR7HU3.js";
import {
  d,
  l
} from "./chunk-JLE6P4DW.js";
import "./chunk-OHLUZSH7.js";
import "./chunk-QV5AXXWQ.js";
import "./chunk-CL7UAIKB.js";
import {
  j as j2
} from "./chunk-F3SBJW2O.js";
import "./chunk-YVCC2Z32.js";
import "./chunk-ODFH3BSN.js";
import {
  m as m2
} from "./chunk-YC3PYTAZ.js";
import "./chunk-46JSCFRH.js";
import "./chunk-JZM5YUHA.js";
import "./chunk-VPF2CM6B.js";
import {
  s as s3
} from "./chunk-JCWF5RB4.js";
import {
  m,
  y
} from "./chunk-TBBTJ7N4.js";
import "./chunk-NUI5LCQ5.js";
import {
  a2
} from "./chunk-AS7ITRBV.js";
import {
  e
} from "./chunk-PD5Q7TDW.js";
import {
  T
} from "./chunk-SF7FIURP.js";
import "./chunk-K7YQIZQM.js";
import {
  a2 as a3
} from "./chunk-H3ETM4DZ.js";
import {
  L,
  St,
  T as T2,
  ot,
  tt
} from "./chunk-TXAS6RAG.js";
import {
  j
} from "./chunk-G72U56FP.js";
import "./chunk-DWOEYHKS.js";
import {
  s2 as s,
  s3 as s2
} from "./chunk-JGYHKABU.js";
import {
  a,
  o
} from "./chunk-3FXB2ZFK.js";
import {
  R
} from "./chunk-WQNVH5M4.js";
import "./chunk-76J2PTFD.js";

// node_modules/@arcgis/core/layers/support/FacilityLayerInfo.js
var s5 = class extends l {
  constructor(r3) {
    super(r3), this.facilityIdField = null, this.layerId = null, this.nameField = null, this.siteIdField = null, this.sublayerId = null;
  }
};
e([y({ type: String, json: { write: true } })], s5.prototype, "facilityIdField", void 0), e([y({ type: String, json: { write: true } })], s5.prototype, "layerId", void 0), e([y({ type: String, json: { write: true } })], s5.prototype, "nameField", void 0), e([y({ type: String, json: { write: true } })], s5.prototype, "siteIdField", void 0), e([y({ type: Number, json: { read: { source: "subLayerId" }, write: { target: "subLayerId" }, origins: { "web-scene": { read: false, write: false } } } })], s5.prototype, "sublayerId", void 0), s5 = e([a2("esri.layers.support.FacilityLayerInfo")], s5);
var i5 = s5;

// node_modules/@arcgis/core/layers/support/LevelLayerInfo.js
var i6 = class extends l {
  constructor(e3) {
    super(e3), this.facilityIdField = null, this.layerId = null, this.levelIdField = null, this.levelNumberField = null, this.longNameField = null, this.shortNameField = null, this.sublayerId = null, this.verticalOrderField = null;
  }
};
e([y({ type: String, json: { write: true } })], i6.prototype, "facilityIdField", void 0), e([y({ type: String, json: { write: true } })], i6.prototype, "layerId", void 0), e([y({ type: String, json: { write: true } })], i6.prototype, "levelIdField", void 0), e([y({ type: String, json: { write: true } })], i6.prototype, "levelNumberField", void 0), e([y({ type: String, json: { write: true } })], i6.prototype, "longNameField", void 0), e([y({ type: String, json: { write: true } })], i6.prototype, "shortNameField", void 0), e([y({ type: Number, json: { read: { source: "subLayerId" }, write: { target: "subLayerId" }, origins: { "web-scene": { read: false, write: false } } } })], i6.prototype, "sublayerId", void 0), e([y({ type: String, json: { write: true } })], i6.prototype, "verticalOrderField", void 0), i6 = e([a2("esri.layers.support.LevelLayerInfo")], i6);
var s6 = i6;

// node_modules/@arcgis/core/layers/support/SiteLayerInfo.js
var s7 = class extends l {
  constructor(r3) {
    super(r3), this.layerId = null, this.nameField = null, this.siteIdField = null, this.sublayerId = null;
  }
};
e([y({ type: String, json: { write: true } })], s7.prototype, "layerId", void 0), e([y({ type: String, json: { write: true } })], s7.prototype, "nameField", void 0), e([y({ type: String, json: { write: true } })], s7.prototype, "siteIdField", void 0), e([y({ type: Number, json: { read: { source: "subLayerId" }, write: { target: "subLayerId" }, origins: { "web-scene": { read: false, write: false } } } })], s7.prototype, "sublayerId", void 0), s7 = e([a2("esri.layers.support.SiteLayerInfo")], s7);
var i7 = s7;

// node_modules/@arcgis/core/support/MapFloorInfo.js
var a5 = class extends l {
  constructor(r3) {
    super(r3), this.levelLayer = null, this.facilityLayer = null, this.siteLayer = null;
  }
};
e([y({ type: s6, json: { write: true } })], a5.prototype, "levelLayer", void 0), e([y({ type: i5, json: { write: true } })], a5.prototype, "facilityLayer", void 0), e([y({ type: i7, json: { write: true } })], a5.prototype, "siteLayer", void 0), a5 = e([a2("esri.support.MapFloorInfo")], a5);
var l5 = a5;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/ExpressionInfo.js
var p3 = class extends i(l) {
  constructor(r3) {
    super(r3), this.expression = null, this.returnType = "string", this.title = null;
  }
};
e([y({ type: String, json: { write: { isRequired: true } } })], p3.prototype, "expression", void 0), e([y({ type: ["number", "string"], json: { write: true } })], p3.prototype, "returnType", void 0), e([y({ type: String, json: { write: true } })], p3.prototype, "title", void 0), p3 = e([a2("esri.webdoc.geotriggersInfo.ExpressionInfo")], p3);
var i8 = p3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/DeviceLocationFeed.js
var c2 = new s3({ deviceLocation: "device-location" });
var a6 = class extends i(l) {
  constructor(o6) {
    super(o6), this.filterExpression = null, this.type = "device-location";
  }
};
e([y({ type: i8, json: { write: true } })], a6.prototype, "filterExpression", void 0), e([y({ type: c2.apiValues, readOnly: true, json: { type: c2.jsonValues, read: c2.read, write: c2.write } })], a6.prototype, "type", void 0), a6 = e([a2("esri.webdoc.geotriggersInfo.DeviceLocationFeed")], a6);
var n3 = a6;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFilter.js
var c3 = class extends i(l) {
  constructor(r3) {
    super(r3), this.geometry = null, this.where = null;
  }
};
e([y({ types: n, json: { read: p, write: true } })], c3.prototype, "geometry", void 0), e([y({ type: String, json: { write: true } })], c3.prototype, "where", void 0), c3 = e([a2("esri.webdoc.geotriggersInfo.FeatureFilter")], c3);
var m4 = c3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureLayerSource.js
var p4 = class extends i(l) {
  constructor(r3) {
    super(r3), this.layerId = null, this.layerUrl = null, this.type = "feature-layer";
  }
};
e([y({ type: String, json: { write: { overridePolicy() {
  return { isRequired: null === this.layerUrl };
} } } })], p4.prototype, "layerId", void 0), e([y({ type: String, json: { write: { overridePolicy() {
  return { isRequired: null === this.layerId };
} } } })], p4.prototype, "layerUrl", void 0), e([o3({ featureLayer: "feature-layer" }, { readOnly: true })], p4.prototype, "type", void 0), p4 = e([a2("esri.webdoc.geotriggersInfo.FeatureLayerSource")], p4);
var a7 = p4;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FeatureFenceParameters.js
var a8 = class extends i(l) {
  constructor(r3) {
    super(r3), this.fenceSource = null, this.filter = null, this.bufferDistance = null, this.type = "features";
  }
};
e([y({ type: a7, json: { write: { isRequired: true } } })], a8.prototype, "fenceSource", void 0), e([y({ type: m4, json: { write: true } })], a8.prototype, "filter", void 0), e([y({ type: Number, json: { write: true } })], a8.prototype, "bufferDistance", void 0), e([o3({ features: "features" }, { readOnly: true })], a8.prototype, "type", void 0), a8 = e([a2("esri.webdoc.geotriggersInfo.FeatureFenceParameters")], a8);
var u2 = a8;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/Geotrigger.js
var c4 = class extends i(l) {
  constructor(r3) {
    super(r3), this.type = "fence";
  }
};
e([o3({ fence: "fence" }, { readOnly: true })], c4.prototype, "type", void 0), c4 = e([a2("esri.webdoc.geotriggersInfo.Geotrigger")], c4);
var p5 = c4;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/GeotriggerNotificationOptions.js
var i9 = class extends i(l) {
  constructor(o6) {
    super(o6), this.expressionInfo = null, this.requestedActions = null;
  }
};
e([y({ type: i8, json: { write: true } })], i9.prototype, "expressionInfo", void 0), e([y({ type: [String], json: { write: true } })], i9.prototype, "requestedActions", void 0), i9 = e([a2("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")], i9);
var c5 = i9;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/support/typeUtils.js
var t2 = new s3({ enterContainsAndExitDoesNotContain: "enter-contains-and-exit-does-not-contain", enterContainsAndExitDoesNotIntersect: "enter-contains-and-exit-does-not-intersect", enterIntersectsAndExitDoesNotIntersect: "enter-intersects-and-exit-does-not-intersect" });
var n4 = new s3({ useGeometry: "use-geometry", useGeometryWithAccuracy: "use-geometry-with-accuracy" });
var o4 = new s3({ enter: "enter", enterOrExit: "enter-or-exit", exit: "exit" });

// node_modules/@arcgis/core/webdoc/geotriggersInfo/FenceGeotrigger.js
var d3 = class extends p5 {
  constructor(e3) {
    super(e3), this.enterExitRule = "enter-contains-and-exit-does-not-intersect", this.feed = null, this.feedAccuracyMode = "use-geometry", this.fenceNotificationRule = null, this.fenceParameters = null, this.name = null, this.notificationOptions = null, this.type = "fence";
  }
};
e([o3(t2)], d3.prototype, "enterExitRule", void 0), e([y({ type: n3, json: { write: { isRequired: true } } })], d3.prototype, "feed", void 0), e([o3(n4)], d3.prototype, "feedAccuracyMode", void 0), e([y({ type: o4.apiValues, json: { type: o4.jsonValues, read: o4.read, write: { writer: o4.write, isRequired: true } } })], d3.prototype, "fenceNotificationRule", void 0), e([y({ type: u2, json: { write: { isRequired: true } } })], d3.prototype, "fenceParameters", void 0), e([y({ type: String, json: { write: true } })], d3.prototype, "name", void 0), e([y({ type: c5, json: { write: true } })], d3.prototype, "notificationOptions", void 0), e([o3({ fence: "fence" }, { readOnly: true })], d3.prototype, "type", void 0), d3 = e([a2("esri.webdoc.geotriggersInfo.FenceGeotrigger")], d3);
var m5 = d3;

// node_modules/@arcgis/core/webdoc/geotriggersInfo/support/geotriggerTypes.js
var o5 = { base: p5, key: "type", typeMap: { fence: m5 } };

// node_modules/@arcgis/core/webdoc/GeotriggersInfo.js
var c6 = class extends i(l) {
  constructor(r3) {
    super(r3), this.geotriggers = null;
  }
};
e([y({ types: [o5], json: { write: { isRequired: true } } })], c6.prototype, "geotriggers", void 0), c6 = e([a2("esri.webdoc.GeotriggersInfo")], c6);
var i10 = c6;

// node_modules/@arcgis/core/webdoc/RangeInfo.js
var s8;
var a9 = s8 = class extends l {
  constructor(e3) {
    super(e3), this.activeRange = null, this.currentRangeExtent = null, this.fullRangeExtent = null;
  }
  clone() {
    return new s8(a({ activeRange: this.activeRange, currentRangeExtent: this.currentRangeExtent, fullRangeExtent: this.fullRangeExtent }));
  }
};
e([y({ type: String, nonNullable: true, json: { read: { source: "activeRangeName" }, write: { target: "activeRangeName", isRequired: true } } })], a9.prototype, "activeRange", void 0), e([y({ type: [Number], json: { write: true } })], a9.prototype, "currentRangeExtent", void 0), e([y({ type: [Number], json: { write: true } })], a9.prototype, "fullRangeExtent", void 0), a9 = s8 = e([a2("esri.webdoc.RangeInfo")], a9);
var c7 = a9;

// node_modules/@arcgis/core/webdoc/widgets/FloorFilter.js
var s9;
var n5 = s9 = class extends l {
  constructor(e3) {
    super(e3), this.enabled = false, this.longNames = false, this.minimized = false, this.pinnedLevels = false, this.site = null, this.facility = null, this.level = null;
  }
  clone() {
    return new s9(a({ enabled: this.enabled, longNames: this.longNames, minimized: this.minimized, pinnedLevels: this.pinnedLevels, site: this.site, facility: this.facility, level: this.level }));
  }
};
e([y({ type: Boolean, json: { read: { source: "enabled" }, write: { target: "enabled" } } })], n5.prototype, "enabled", void 0), e([y({ type: Boolean, json: { read: { source: "longNames" }, write: { target: "longNames" } } })], n5.prototype, "longNames", void 0), e([y({ type: Boolean, json: { read: { source: "minimized" }, write: { target: "minimized" } } })], n5.prototype, "minimized", void 0), e([y({ type: Boolean, json: { read: { source: "pinnedLevels" }, write: { target: "pinnedLevels" } } })], n5.prototype, "pinnedLevels", void 0), e([y({ type: String, json: { read: { source: "site" }, write: { target: "site" } } })], n5.prototype, "site", void 0), e([y({ type: String, json: { read: { source: "facility" }, write: { target: "facility" } } })], n5.prototype, "facility", void 0), e([y({ type: String, json: { read: { source: "level" }, write: { target: "level" } } })], n5.prototype, "level", void 0), n5 = s9 = e([a2("esri.webdoc.widgets.FloorFilter")], n5);
var l6 = n5;

// node_modules/@arcgis/core/webdoc/widgets/Range.js
var i11;
var n6 = new s3({ slider: "slider", picker: "picker" });
var p6 = i11 = class extends l {
  constructor(e3) {
    super(e3), this.interactionMode = null, this.numStops = null, this.stopInterval = null;
  }
  clone() {
    return new i11({ interactionMode: this.interactionMode, numStops: this.numStops, stopInterval: this.stopInterval });
  }
};
e([y({ type: n6.apiValues, nonNullable: true, json: { type: n6.jsonValues, default: null, read: { reader: n6.read }, write: { isRequired: true, writer: n6.write } } })], p6.prototype, "interactionMode", void 0), e([y({ type: Number, json: { read: { source: "numberOfStops" }, write: { target: "numberOfStops", overridePolicy() {
  const e3 = null != this.stopInterval;
  return { enabled: !e3, isRequired: !e3 };
} } } })], p6.prototype, "numStops", void 0), e([y({ type: Number, json: { write: { overridePolicy() {
  return { isRequired: null == this.numStops };
} } } })], p6.prototype, "stopInterval", void 0), p6 = i11 = e([a2("esri.webdoc.widgets.Range")], p6);
var a10 = p6;

// node_modules/@arcgis/core/webdoc/widgets/TimeSlider.js
var a11;
var m6 = a11 = class extends l {
  constructor(t4) {
    super(t4), this.currentTimeExtent = null, this.fullTimeExtent = null, this.loop = false, this.numStops = null, this.numThumbs = null, this.stopDelay = null, this.stopInterval = null, this.stops = null;
  }
  readCurrentTimeExtent(t4) {
    if (!t4)
      return;
    const r3 = null != t4[0] ? new Date(t4[0]) : null, o6 = null != t4[1] ? new Date(t4[1]) : null;
    return new c({ start: r3, end: o6 });
  }
  writeCurrentTimeExtent(t4, e3, r3) {
    t4 && o(r3, [null != t4.start ? t4.start.getTime() : null, null != t4.end ? t4.end.getTime() : null], e3);
  }
  readFullTimeExtent(t4, r3) {
    const o6 = r3.properties;
    if (!o6)
      return;
    const s11 = null != o6.endTime ? new Date(o6.endTime) : null, n10 = null != o6.startTime ? new Date(o6.startTime) : null;
    return new c({ start: n10, end: s11 });
  }
  writeFullTimeExtent(t4, e3) {
    if (!t4)
      return;
    const r3 = e3.properties = e3.properties || {}, o6 = t4.end, s11 = t4.start;
    o6 && (r3.endTime = null != o6 ? o6.getTime() : null), s11 && (r3.startTime = null != s11 ? s11.getTime() : null);
  }
  readStopInterval(t4, e3, o6) {
    return t4 ? l3.fromJSON({ value: t4.interval, unit: t4.units }, o6) : null;
  }
  writeStopInterval(t4, e3, r3, o6) {
    if (!t4)
      return;
    const s11 = t4.toJSON(o6);
    o(r3, { interval: s11.value, units: s11.unit }, e3);
  }
  readStops(t4) {
    return t4 && t4.length ? t4.map((t5) => new Date(t5)) : null;
  }
  writeStops(t4, e3, r3) {
    t4 && t4.length && o(r3, t4.map((t5) => t5.getTime()), e3);
  }
  clone() {
    return new a11(a({ currentTimeExtent: this.currentTimeExtent, fullTimeExtent: this.fullTimeExtent, loop: this.loop, numStops: this.numStops, numThumbs: this.numThumbs, stopDelay: this.stopDelay, stopInterval: this.stopInterval, stops: this.stops }));
  }
};
e([y({ type: c, json: { read: { source: "properties.currentTimeExtent" }, write: { target: "properties.currentTimeExtent" } } })], m6.prototype, "currentTimeExtent", void 0), e([o2("currentTimeExtent")], m6.prototype, "readCurrentTimeExtent", null), e([r("currentTimeExtent")], m6.prototype, "writeCurrentTimeExtent", null), e([y({ type: c, json: { read: { source: ["properties.endTime", "properties.startTime"] }, write: { target: { "properties.endTime": { type: Number }, "properties.startTime": { type: Number } } } } })], m6.prototype, "fullTimeExtent", void 0), e([o2("fullTimeExtent")], m6.prototype, "readFullTimeExtent", null), e([r("fullTimeExtent")], m6.prototype, "writeFullTimeExtent", null), e([y({ type: Boolean, nonNullable: true, json: { default: false, read: { source: "properties.loop" }, write: { target: "properties.loop" } } })], m6.prototype, "loop", void 0), e([y({ type: Number, json: { read: { source: "properties.numberOfStops" }, write: { target: "properties.numberOfStops", overridePolicy() {
  var _a;
  const t4 = !!this.stopInterval, e3 = !!((_a = this.stops) == null ? void 0 : _a.length), r3 = !(t4 || e3);
  return { enabled: r3, isRequired: r3 };
} } } })], m6.prototype, "numStops", void 0), e([y({ type: [1, 2], nonNullable: true, json: { read: { source: "properties.thumbCount" }, write: { target: "properties.thumbCount", isRequired: true } } })], m6.prototype, "numThumbs", void 0), e([y({ type: Number, nonNullable: true, json: { read: { source: "properties.thumbMovingRate" }, write: { target: "properties.thumbMovingRate", isRequired: true } } })], m6.prototype, "stopDelay", void 0), e([y({ type: l3, json: { read: { source: "properties.timeStopInterval" }, write: { target: "properties.timeStopInterval", overridePolicy() {
  var _a;
  const t4 = null != this.numStops, e3 = !!((_a = this.stops) == null ? void 0 : _a.length);
  return { enabled: !e3, isRequired: !(t4 || e3) };
} } } })], m6.prototype, "stopInterval", void 0), e([o2("stopInterval")], m6.prototype, "readStopInterval", null), e([r("stopInterval")], m6.prototype, "writeStopInterval", null), e([y({ type: [Date], json: { read: { source: "properties.stops" }, write: { target: "properties.stops", overridePolicy() {
  return { isRequired: null == this.numStops && !this.stopInterval };
} } } })], m6.prototype, "stops", void 0), e([o2("stops")], m6.prototype, "readStops", null), e([r("stops")], m6.prototype, "writeStops", null), m6 = a11 = e([a2("esri.webdoc.widgets.TimeSlider")], m6);
var c8 = m6;

// node_modules/@arcgis/core/webdoc/Widgets.js
var m7;
var c9 = m7 = class extends l {
  constructor(r3) {
    super(r3), this.range = null, this.timeSlider = null, this.floorFilter = null;
  }
  clone() {
    return new m7(a({ range: this.range, timeSlider: this.timeSlider, floorFilter: this.floorFilter }));
  }
};
e([y({ type: a10, json: { write: true } })], c9.prototype, "range", void 0), e([y({ type: c8, json: { write: true } })], c9.prototype, "timeSlider", void 0), e([y({ type: l6, json: { write: true } })], c9.prototype, "floorFilter", void 0), c9 = m7 = e([a2("esri.webdoc.Widgets")], c9);
var n7 = c9;

// node_modules/@arcgis/core/webdoc/support/thumbnailUtils.js
var h2 = { width: 600, height: 400 };
var t3 = 1.5;
function i12(i17, e3) {
  e3 = e3 || h2;
  let { width: d4, height: n10 } = e3;
  const g3 = d4 / n10;
  return g3 < t3 ? n10 = d4 / t3 : g3 > t3 && (d4 = n10 * t3), d4 > i17.width && (n10 *= i17.width / d4, d4 = i17.width), n10 > i17.height && (d4 *= i17.height / n10, n10 = i17.height), { width: Math.round(d4), height: Math.round(n10) };
}

// node_modules/@arcgis/core/core/accessorSupport/extensions/serializableProperty/writePolicyUtils.js
function e2(e3) {
  return { enabled: !!(e3 == null ? void 0 : e3.length) };
}

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchLayerField.js
var c10;
var a12 = c10 = class extends l {
  constructor(r3) {
    super(r3), this.exactMatch = false, this.name = null, this.type = null;
  }
  clone() {
    return new c10({ exactMatch: this.exactMatch, type: this.type, name: this.name });
  }
};
e([y({ type: Boolean, json: { write: true } })], a12.prototype, "exactMatch", void 0), e([y({ type: String, json: { write: true } })], a12.prototype, "name", void 0), e([o3(i2)], a12.prototype, "type", void 0), a12 = c10 = e([a2("esri.webdoc.applicationProperties.SearchLayerField")], a12);
var i13 = a12;

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchLayer.js
var c11;
var a13 = c11 = class extends l {
  constructor(r3) {
    super(r3), this.field = null, this.id = null, this.subLayer = null;
  }
  clone() {
    return new c11(a({ field: this.field, id: this.id, subLayer: this.subLayer }));
  }
};
e([y({ type: i13, json: { write: { isRequired: true } } })], a13.prototype, "field", void 0), e([y({ type: String, json: { write: { isRequired: true } } })], a13.prototype, "id", void 0), e([y({ type: T, json: { write: true } })], a13.prototype, "subLayer", void 0), a13 = c11 = e([a2("esri.webdoc.applicationProperties.SearchLayer")], a13);
var u3 = a13;

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchTableField.js
var c12;
var a14 = c12 = class extends l {
  constructor(r3) {
    super(r3), this.exactMatch = false, this.name = null, this.type = null;
  }
  clone() {
    return new c12({ exactMatch: this.exactMatch, type: this.type, name: this.name });
  }
};
e([y({ type: Boolean, json: { write: true } })], a14.prototype, "exactMatch", void 0), e([y({ type: String, json: { write: true } })], a14.prototype, "name", void 0), e([o3(i2)], a14.prototype, "type", void 0), a14 = c12 = e([a2("esri.webdoc.applicationProperties.SearchTableField")], a14);
var i14 = a14;

// node_modules/@arcgis/core/webdoc/applicationProperties/SearchTable.js
var p7;
var c13 = p7 = class extends l {
  constructor(r3) {
    super(r3), this.field = null, this.id = null;
  }
  clone() {
    return new p7(a({ field: this.field, id: this.id }));
  }
};
e([y({ type: i14, json: { write: { isRequired: true } } })], c13.prototype, "field", void 0), e([y({ type: String, json: { write: { isRequired: true } } })], c13.prototype, "id", void 0), c13 = p7 = e([a2("esri.webdoc.applicationProperties.SearchTable")], c13);
var l7 = c13;

// node_modules/@arcgis/core/webdoc/applicationProperties/Search.js
var p8;
var b2 = V.ofType(u3);
var h3 = V.ofType(l7);
var u4 = p8 = class extends l {
  constructor(e3) {
    super(e3), this.addressSearchEnabled = true, this.enabled = true, this.hintText = null, this.layers = new b2(), this.tables = new h3();
  }
  readAddressSearchEnabled(e3) {
    return !e3;
  }
  writeAddressSearchEnabled(e3, r3, o6) {
    r3[o6] = !e3;
  }
  clone() {
    return new p8(a({ addressSearchEnabled: this.addressSearchEnabled, enabled: this.enabled, hintText: this.hintText, layers: this.layers, tables: this.tables }));
  }
};
e([y({ type: Boolean, nonNullable: true, json: { read: { source: "disablePlaceFinder" }, write: { target: "disablePlaceFinder", isRequired: true }, origins: { "web-scene": { read: false, write: false } } } })], u4.prototype, "addressSearchEnabled", void 0), e([o2("addressSearchEnabled")], u4.prototype, "readAddressSearchEnabled", null), e([r("addressSearchEnabled")], u4.prototype, "writeAddressSearchEnabled", null), e([y({ type: Boolean, nonNullable: true, json: { write: true, origins: { "web-map": { write: { isRequired: true } }, "web-scene": { default: true, write: true } } } })], u4.prototype, "enabled", void 0), e([y({ type: String, json: { write: true } })], u4.prototype, "hintText", void 0), e([y({ type: b2, json: { write: { overridePolicy: e2 }, origins: { "web-scene": { write: { isRequired: true } } } } })], u4.prototype, "layers", void 0), e([y({ type: h3, json: { read: true, write: { overridePolicy: e2 } } })], u4.prototype, "tables", void 0), u4 = p8 = e([a2("esri.webdoc.applicationProperties.Search")], u4);
var y2 = u4;

// node_modules/@arcgis/core/webdoc/applicationProperties/Viewing.js
var p9;
var a15 = p9 = class extends l {
  constructor(r3) {
    super(r3), this.search = null;
  }
  clone() {
    return new p9(a({ search: this.search }));
  }
};
e([y({ type: y2, json: { write: true } })], a15.prototype, "search", void 0), a15 = p9 = e([a2("esri.webdoc.applicationProperties.Viewing")], a15);
var i15 = a15;

// node_modules/@arcgis/core/webmap/ApplicationProperties.js
var p10;
var n8 = p10 = class extends l {
  constructor(o6) {
    super(o6), this.editing = null, this.offline = null, this.viewing = null;
  }
  clone() {
    return new p10(a({ editing: this.editing, offline: this.offline, viewing: this.viewing }));
  }
};
e([y({ json: { write: true } })], n8.prototype, "editing", void 0), e([y({ json: { write: true } })], n8.prototype, "offline", void 0), e([y({ type: i15, json: { write: true } })], n8.prototype, "viewing", void 0), n8 = p10 = e([a2("esri.webmap.ApplicationProperties")], n8);
var c14 = n8;

// node_modules/@arcgis/core/webmap/InitialViewProperties.js
var c15;
var l8 = c15 = class extends m {
  constructor(o6) {
    super(o6), this.background = null, this.rangeInfo = null, this.spatialReference = null, this.viewpoint = null;
  }
  clone() {
    return new c15(a({ background: this.background, rangeInfo: this.rangeInfo, spatialReference: this.spatialReference, viewpoint: this.viewpoint }));
  }
};
e([y({ type: m3 })], l8.prototype, "background", void 0), e([y({ type: c7 })], l8.prototype, "rangeInfo", void 0), e([y({ type: f })], l8.prototype, "spatialReference", void 0), e([y({ type: l4 })], l8.prototype, "viewpoint", void 0), l8 = c15 = e([a2("esri.webmap.InitialViewProperties")], l8);
var m8 = l8;

// node_modules/@arcgis/core/webmap/initialViewPropertiesUtils.js
async function n9(t4, r3, o6) {
  var _a;
  const n10 = (_a = t4 == null ? void 0 : t4.viewpoint) == null ? void 0 : _a.targetGeometry;
  if (n10)
    return null;
  const s11 = await i16(t4, r3, o6);
  if (!s11)
    return null;
  return new l4({ targetGeometry: s11 });
}
async function i16(e3, n10, i17) {
  const s11 = e3 == null ? void 0 : e3.spatialReference, a16 = n10 == null ? void 0 : n10.extent;
  if (!s11 || !a16)
    return null;
  if (s11.isWGS84)
    return a16.clone();
  if (s11.isWebMercator)
    return d2(a16);
  const { getGeometryServiceURL: c16 } = await import("./geometryServiceUtils-JDAQ4LZZ.js");
  try {
    const e4 = await c16(n10), t4 = new a4();
    t4.geometries = [a16], t4.outSpatialReference = s11;
    return (await n2(e4, t4))[0];
  } catch (p11) {
    i17.error("Error projecting item's extent:", p11);
  }
  return null;
}

// node_modules/@arcgis/core/webmap/Version.js
var s10 = class extends r2 {
  constructor(r3, s11) {
    super(r3, s11, "webmap");
  }
};

// node_modules/@arcgis/core/WebMap.js
var re = new s10(2, 28);
var ie = "Web Map";
var oe = V.ofType(f3);
var ae = V.ofType(g2);
var se = /* @__PURE__ */ new Map();
se.set("image/jpeg", "jpeg"), se.set("image/jpg", "jpg"), se.set("image/png", "png"), se.set("image/gif", "gif");
var ne = "ArcGIS Pro";
var le = l2.JSAPI;
var pe = "CollectorDisabled";
var me = "Collector";
var ue = "Data Editing";
var he = "OfflineDisabled";
var de = "Offline";
var ce = "Workforce Project";
var ye = "Workforce Worker";
var we = "Workforce Dispatcher";
var fe = "Offline Map Areas";
var ge = "FieldMapsDisabled";
var be = l2.DEVELOPER_BASEMAP;
var _e = "UtilityNetwork";
var ve = ["NatGeo_World_Map", "Ocean_Basemap", "USA_Topo_Maps", "World_Imagery", "World_Street_Map", "World_Terrain_Base", "World_Topo_Map", "World_Hillshade", "Canvas/World_Light_Gray_Base", "Canvas/World_Light_Gray_Reference", "Canvas/World_Dark_Gray_Base", "Canvas/World_Dark_Gray_Reference", "Ocean/World_Ocean_Base", "Ocean/World_Ocean_Reference", "Reference/World_Boundaries_and_Places", "Reference/World_Reference_Overlay", "Reference/World_Transportation"].map((e3) => e3.toLowerCase());
var Ae = class extends O(_.LoadableMixin(m2(j4))) {
  constructor(e3) {
    super(e3), this._isAuthoringAppSetByUser = false, this._isAuthoringAppVersionSetByUser = false, this._thumbnailFilename = null, this._updateFromPromise = null, this._resourceReferences = { portalItem: null, paths: [] }, this.applicationProperties = null, this.bookmarks = new oe(), this.floorInfo = null, this.geotriggersInfo = null, this.initialViewProperties = new m8(), this.portalItem = null, this.presentation = null, this.sourceVersion = null, this.widgets = null, this.utilityNetworks = null, this.authoringApp = this.authoringAppVersion = null, this._isAuthoringAppSetByUser = this._isAuthoringAppVersionSetByUser = false;
  }
  destroy() {
    const e3 = this.portalItem;
    this.portalItem = null, e3 == null ? void 0 : e3.destroy();
  }
  initialize() {
    if (this.when().catch((e3) => {
      s.getLogger(this).error("#load()", "Failed to load web map", e3);
    }), this.resourceInfo) {
      let t4;
      try {
        t4 = this._validateJSON(this.resourceInfo);
      } catch (e3) {
        return void this.addResolvingPromise(Promise.reject(e3));
      }
      this.read(t4);
    }
  }
  set authoringApp(e3) {
    this._isAuthoringAppSetByUser = true, this._set("authoringApp", e3);
  }
  writeAuthoringApp(e3, t4) {
    e3 && this._isAuthoringAppSetByUser ? t4.authoringApp = e3 : t4.authoringApp = le;
  }
  set authoringAppVersion(e3) {
    this._isAuthoringAppVersionSetByUser = true, this._set("authoringAppVersion", e3);
  }
  writeAuthoringAppVersion(e3, r3) {
    e3 && this._isAuthoringAppVersionSetByUser ? r3.authoringAppVersion = e3 : r3.authoringAppVersion = a3;
  }
  readInitialViewProperties(e3, t4) {
    var _a;
    const r3 = new m8();
    t4.background && (r3.background = m3.fromJSON(t4.background));
    const o6 = (_a = t4.initialState) == null ? void 0 : _a.viewpoint;
    if (o6) {
      if (o6.rotation) {
        s10.parse(t4.version || "", "webmap").lessThan(2, 20) && t4.authoringApp === ne && (o6.rotation *= -1);
      }
      r3.viewpoint = l4.fromJSON(o6);
    }
    return t4.mapRangeInfo && (r3.rangeInfo = c7.fromJSON(t4.mapRangeInfo)), t4.spatialReference && (r3.spatialReference = f.fromJSON(t4.spatialReference)), r3;
  }
  writeInitialViewProperties(e3, t4, r3, i17) {
    if (!e3)
      return;
    const o6 = e3.background;
    o6 && o6.color && (t4.background = o6.write({}, i17)), e3.viewpoint && (t4.initialState = { viewpoint: e3.viewpoint.write({}, i17) }), e3.rangeInfo && (t4.mapRangeInfo = e3.rangeInfo.toJSON(i17)), e3.spatialReference && (t4.spatialReference = e3.spatialReference.write({}, i17));
  }
  writeLayers(e3, t4, r3, i17) {
    t4[r3] = this._writeLayers(e3, i17, "operational-layers");
  }
  readSourceVersion(e3, t4) {
    const [r3, i17] = t4.version.split(".");
    return new s10(parseInt(r3, 10), parseInt(i17, 10));
  }
  writeSourceVersion(e3, t4, r3) {
    t4[r3] = `${re.major}.${re.minor}`;
  }
  writeTables(e3, t4, r3, i17) {
    const o6 = this._writeLayers(e3, i17, "tables");
    o6.length && (t4[r3] = o6);
  }
  get thumbnailUrl() {
    return this.portalItem && this.portalItem.thumbnailUrl || null;
  }
  set thumbnailUrl(e3) {
    e3 ? (this._override("thumbnailUrl", e3), this._thumbnailFilename = this._generateCustomThumbnailFilename(e3)) : this._clearThumbnailOverride();
  }
  load(e3) {
    return this.addResolvingPromise(this._loadFromSource()), Promise.resolve(this);
  }
  loadAll() {
    return t(this, (e3) => {
      e3(this.ground, this.basemap, this.layers, this.tables);
    });
  }
  read(e3, t4) {
    t4 = { ...t4, origin: "web-map" };
    const r3 = this._getAuthoringPropsState();
    d(this, e3, (t5) => super.read(e3, t5), t4), this._restoreAuthoringPropsFromState(r3);
  }
  write(e3, t4) {
    if ("loaded" !== this.loadStatus) {
      const e4 = new s2("webmap:not-loaded", "Web map must be loaded before it can be serialized");
      throw s.getLogger(this).error("#toJSON()", "Web map must be loaded before it can be serialized", this.loadError || this.loadStatus), e4;
    }
    return this._removeDanglingLayerRefs(), t4 = { ...t4, origin: "web-map", restrictedWebMapWriting: true, webmap: this }, super.write(e3, t4);
  }
  async save(e3) {
    e3 = e3 || {}, this._validateItem();
    const t4 = import("./saveUtils-BXQTT6CZ.js");
    await this._updateFromPromise, await this.load(), await this._loadLayerContainers(), await this._beforeSave(), await this._validateMap();
    const r3 = this.portalItem, i17 = L(r3.itemUrl), o6 = { origin: "web-map", messages: [], writtenProperties: [], url: i17, portal: r3.portal || j3.getDefault(), portalItem: r3, verifyItemRelativeUrls: i17 ? { rootPath: i17.path, writtenUrls: [] } : null, blockedRelativeUrls: [], resources: { toAdd: [], toUpdate: [], toKeep: [], pendingOperations: [] } }, a16 = this.write({}, o6);
    return await Promise.all(o6.resources.pendingOperations), this._validateJSONForWriting(o6, e3), await this._updateItemProperties(r3), await this._updateItem(r3, a16, o6), await Promise.all([this._updateItemThumbnail(), t4.then(({ saveResources: e4 }) => e4(this._resourceReferences, o6, null))]), r3;
  }
  async saveAs(e3, t4) {
    t4 = t4 || {};
    const r3 = this._getPortalItem(e3), i17 = import("./saveUtils-BXQTT6CZ.js");
    await this._updateFromPromise, await this.load(), await this._loadLayerContainers(), await this._beforeSave(), await this._validateMap();
    const o6 = { origin: "web-map", messages: [], writtenProperties: [], url: null, portal: r3.portal, portalItem: r3, blockedRelativeUrls: [], resources: { toAdd: [], toUpdate: [], toKeep: [], pendingOperations: [] } }, a16 = this.write({}, o6);
    await Promise.all(o6.resources.pendingOperations), this._validateJSONForWriting(o6, t4), await this._updateItemPropertiesForSaveAs(r3);
    const s11 = this._getThumbnailState();
    return await this._createItem(r3, a16, o6, t4) && (this._resourceReferences.portalItem = r3), this._restoreThumbnailFromState(s11), await Promise.all([this._updateItemThumbnail(), i17.then(({ saveResources: e4 }) => e4(this._resourceReferences, o6, null))]), r3;
  }
  async updateFrom(e3, t4) {
    const r3 = this._updateFromInternal(e3, t4);
    this._updateFromPromise = r3, await r3;
    r3 === this._updateFromPromise && (this._updateFromPromise = null);
  }
  getLayerJSONFromResourceInfo(e3) {
    var _a, _b, _c, _d;
    const t4 = this.resourceInfo;
    return this._collectAllLayersJSON([...((_a = t4 == null ? void 0 : t4.baseMap) == null ? void 0 : _a.baseMapLayers) || [], ...(t4 == null ? void 0 : t4.operationalLayers) || [], ...((_d = (_c = (_b = this.basemap) == null ? void 0 : _b.resourceInfo) == null ? void 0 : _c.data) == null ? void 0 : _d.baseMapLayers) || []]).find((t5) => t5.id === e3.id);
  }
  _collectAllLayersJSON(e3) {
    return e3.reduce((e4, t4) => (e4.push(t4), "GroupLayer" === t4.layerType && (e4 = e4.concat(this._collectAllLayersJSON(t4.layers || []))), e4), []);
  }
  _writeLayers(e3, t4, r3) {
    t4 = { ...t4, layerContainerType: r3 };
    return e3.map((e4) => f2(e4, "tables" === r3 ? null : this.getLayerJSONFromResourceInfo(e4), t4)).filter(R).toArray();
  }
  _loadFromSource() {
    return this.resourceInfo ? this._loadFromJSON(this.resourceInfo, { origin: "web-map" }) : this.portalItem && this.portalItem.id ? this._loadFromItem(this.portalItem) : Promise.resolve();
  }
  async _loadFromItem(e3) {
    var _a;
    if (await e3.load().catch((e4) => {
      throw new s2("webmap:load-portal-item", "Failed to load portal item", { error: e4 });
    }), "Web Map" !== e3.type)
      throw new s2("webmap:invalid-portal-item", `Invalid portal item type '${e3.type}', expected 'Web Map'`, { type: e3.type });
    const t4 = await e3.fetchData();
    this.resourceInfo = t4;
    const r3 = { origin: "web-map", url: L(e3.itemUrl), portal: e3.portal || j3.getDefault(), portalItem: e3, readResourcePaths: [] };
    await this._readAndLoadFromJSON(t4, r3), this._resourceReferences = { portalItem: e3, paths: r3.readResourcePaths ?? [] };
    const i17 = await n9(this.initialViewProperties, e3, s.getLogger(this));
    if (i17) {
      const e4 = ((_a = this.initialViewProperties) == null ? void 0 : _a.clone()) ?? new m8();
      e4.viewpoint = i17, this.initialViewProperties = e4;
    }
  }
  _readAndLoadFromJSON(e3, t4) {
    const r3 = this._validateJSON(e3);
    return this.read(r3, t4), this._loadFromJSON(r3, t4);
  }
  _validateJSON(e3) {
    const t4 = s10.parse(e3.version || "", "webmap");
    return re.validate(t4), e3.version = `${t4.major}.${t4.minor}`, e3;
  }
  _loadFromJSON(e3, t4) {
    const r3 = { context: { ...t4, layerContainerType: "operational-layers" } };
    return this.portalItem && (r3.context.portal = this.portalItem.portal || j3.getDefault()), import("./layersCreator-KM6C74MA.js").then(({ populateOperationalLayers: t5 }) => {
      const i17 = [], o6 = e3.operationalLayers;
      o6 && o6.length && i17.push(t5(this.layers, o6, r3));
      const a16 = { ...r3, context: { ...r3.context, layerContainerType: "tables" }, defaultLayerType: "ArcGISFeatureLayer" }, s11 = e3.tables;
      return s11 && s11.length && i17.push(t5(this.tables, s11, a16)), j(i17).then(() => {
      });
    });
  }
  _removeDanglingLayerRefs() {
    const e3 = this.applicationProperties, t4 = e3 && e3.viewing && e3.viewing.search, r3 = (e4) => this.allLayers.some((t5) => t5.id === e4);
    t4 && t4.layers && (t4.layers = t4.layers.filter((e4) => r3(e4.id))), t4 && t4.tables && (t4.tables = t4.tables.filter((e4) => this.tables.some((t5) => t5.id === e4.id)));
    const i17 = e3 && e3.editing && e3.editing.locationTracking;
    i17 && i17.info && !r3(i17.info.layerId) && (e3.editing = null);
    const o6 = this.presentation && this.presentation.slides;
    o6 && o6.forEach((e4) => {
      e4.visibleLayers && (e4.visibleLayers = e4.visibleLayers.filter((e5) => r3(e5.id)));
    });
  }
  async _validateMap() {
    var _a;
    if (!((_a = this.basemap) == null ? void 0 : _a.baseLayers.length))
      throw new s2("webmap:save", "Map does not have a valid basemap with a base layer.");
    let e3 = null;
    if (await j2(() => {
      const t4 = I(this.initialViewProperties, this.basemap);
      return e3 = t4.spatialReference, !t4.updating;
    }), !S(e3, this.initialViewProperties.spatialReference))
      throw new s2("webmap:save", "The spatial reference of the basemap is not compatible with the one from the map.", { expected: this.initialViewProperties.spatialReference, actual: e3 });
  }
  _validateItem() {
    if (!this.portalItem)
      throw s.getLogger(this).error("save: requires the portalItem property to be set"), new s2("webmap:portal-item-not-set", "Portal item to save to has not been set on the WebMap");
    this._validateItemType(this.portalItem);
  }
  _validateItemType(e3) {
    if (e3.type !== ie)
      throw new s2("webmap:portal-item-wrong-type", `Portal item needs to have type "${ie}"`);
  }
  _loadLayerContainers() {
    const e3 = [];
    return this.basemap && e3.push(this.basemap.load()), this.ground && e3.push(this.ground.load()), j(e3).then(() => {
    });
  }
  async _beforeSave() {
    const e3 = [];
    for (const t4 of this.allLayers)
      if ("beforeSave" in t4 && "function" == typeof t4.beforeSave) {
        const r3 = t4.beforeSave();
        r3 && e3.push(r3);
      }
    await j(e3);
  }
  _loadAllLayers() {
    const e3 = this._getAllLayersAndTables().map((e4) => e4.load());
    return j(e3).then(() => {
    });
  }
  _getAllLayersAndTables() {
    return this.allLayers.concat(this.allTables);
  }
  _validateJSONForWriting(e3, t4) {
    let r3 = (e3.messages ?? []).filter((e4) => "error" === e4.type).map((e4) => new s2(e4.name, e4.message, e4.details));
    if (e3.blockedRelativeUrls && (r3 = r3.concat(e3.blockedRelativeUrls.map((e4) => new s2("url:unsupported", `Relative url '${e4}' is not supported in Web Map`)))), t4.ignoreUnsupported && (r3 = r3.filter((e4) => "layer:unsupported" !== e4.name && "symbol:unsupported" !== e4.name && "symbol-layer:unsupported" !== e4.name && "property:unsupported" !== e4.name && "url:unsupported" !== e4.name)), r3.length > 0)
      throw new s2("webmap:save", "Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information", { errors: r3 });
  }
  async _updateItemProperties(e3) {
    e3.extent = await this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry), await this._updateTypeKeywords(e3);
  }
  async _updateItemPropertiesForSaveAs(e3) {
    u(e3, pe), u(e3, ge), u(e3, l2.METADATA), u(e3, he), u(e3, fe), u(e3, we), u(e3, ce), u(e3, ye), await this._updateItemProperties(e3);
  }
  async _getWGS84Extent(e3) {
    const t4 = e3.clone().normalize();
    let r3;
    if (t4.length > 1)
      for (const i17 of t4)
        r3 ? i17.width > r3.width && (r3 = i17) : r3 = i17;
    else
      r3 = t4[0];
    return this._projectToWGS84(r3);
  }
  async _projectToWGS84(e3) {
    const t4 = e3.spatialReference;
    if (t4.isWGS84)
      return e3.clone();
    if (t4.isWebMercator)
      return R2(e3);
    const { getGeometryServiceURL: r3 } = await import("./geometryServiceUtils-JDAQ4LZZ.js"), i17 = await r3(this.portalItem), o6 = new a4();
    o6.geometries = [e3], o6.outSpatialReference = f.WGS84;
    return (await n2(i17, o6))[0];
  }
  async _updateTypeKeywords(e3) {
    i3(e3, le), await this._loadAllLayers(), this._evalCollectorKeyword(e3), this._evalDataEditingKeyword(e3), this._evalOfflineKeyword(e3), this._evalDeveloperBasemapKeyword(e3), this._evalUtilityNetworkKeyword(e3), e3.typeKeywords && (e3.typeKeywords = e3.typeKeywords.filter((e4, t4, r3) => r3.indexOf(e4) === t4));
  }
  _evalCollectorKeyword(e3) {
    s4(e3, pe) || s4(e3, ce) || s4(e3, ye) || s4(e3, we) || !this._hasEditableFeatureLayer() ? u(e3, me) : i3(e3, me);
  }
  _evalDataEditingKeyword(e3) {
    this._hasEditableFeatureLayer() ? i3(e3, ue) : u(e3, ue);
  }
  _evalOfflineKeyword(e3) {
    !s4(e3, he) && this._isOfflineCapableMap() ? i3(e3, de) : u(e3, de);
  }
  _evalDeveloperBasemapKeyword(e3) {
    h(this.basemap) ? i3(e3, be) : u(e3, be);
  }
  _evalUtilityNetworkKeyword(e3) {
    var _a;
    ((_a = this.utilityNetworks) == null ? void 0 : _a.length) ? i3(e3, _e) : u(e3, _e);
  }
  _hasEditableFeatureLayer() {
    return this._getAllLayersAndTables().some((e3) => e3.loaded && g(e3) && e3.capabilities.operations.supportsEditing && e3.editingEnabled && ("subtype-group" !== e3.type || e3.sublayers.some((e4) => e4.editingEnabled)));
  }
  _isOfflineCapableMap() {
    return this._getAllLayersAndTables().filter((e3) => "group" !== e3.type).every((e3) => e3.loaded && this._isOfflineCapableLayer(e3));
  }
  _isFeatureCollectionLike(e3) {
    return p2(e3) || "map-notes" === e3.type || "route" === e3.type;
  }
  _isOfflineCapableLayer(e3) {
    return g(e3) && e3.capabilities.operations.supportsSync || this._isFeatureCollectionLike(e3) && !e3.portalItem || ("tile" === e3.type || "vector-tile" === e3.type) && (e3.capabilities.operations.supportsExportTiles || this._isExportableAGOLTileLayer(e3) || R3(e3)) && e3.spatialReference.equals(this.initialViewProperties.spatialReference);
  }
  _isExportableAGOLTileLayer(e3) {
    return "tile" === e3.type && (b(e3.url) && ve.some((t4) => {
      var _a;
      return (_a = e3.url) == null ? void 0 : _a.toLowerCase().includes("/" + t4 + "/");
    }));
  }
  async _updateItem(e3, t4, r3) {
    await e3.update({ data: t4 }), this._syncUpInstanceWithItem(e3, t4, r3);
  }
  async _createItem(e3, t4, r3, i17) {
    const o6 = this.portalItem, a16 = { item: o6, authenticated: !(!(o6 == null ? void 0 : o6.id) || !o6.portal.user) }, n10 = e3.portal;
    await n10.signIn();
    const { copyAllowed: l9, itemReloaded: p11 } = await this._isCopyAllowed(a16, n10);
    if (a16.authenticated || (a16.authenticated = p11), !l9)
      throw new s2("webmap:save-as-copy-not-allowed", "Owner of this map does not allow others to save a copy");
    const m9 = await this._initializeNewItem(e3, a16, t4, i17);
    return this.portalItem = e3, this._syncUpInstanceWithItem(e3, t4, r3), m9;
  }
  async _isCopyAllowed(e3, t4) {
    var _a;
    const { item: r3, authenticated: i17 } = e3;
    return (r3 == null ? void 0 : r3.id) && ((_a = r3.typeKeywords) == null ? void 0 : _a.includes("useOnly")) ? r3.portal.portalHostname !== t4.portalHostname ? { copyAllowed: false, itemReloaded: false } : (i17 || await r3.reload(), { copyAllowed: "admin" === r3.itemControl || "update" === r3.itemControl, itemReloaded: true }) : { copyAllowed: true, itemReloaded: false };
  }
  async _initializeNewItem(e3, t4, r3, i17) {
    var _a;
    const o6 = e3.portal, { item: a16 } = t4, { folder: s11, copyAllResources: n10 } = i17;
    let l9 = false;
    if (n10 && (a16 == null ? void 0 : a16.id) && T2(a16.portal.url, o6.url)) {
      const { total: e4 } = await a16.fetchResources();
      l9 = !!e4;
    }
    if (l9) {
      const t5 = await a16.copy({ copyResources: "all", folder: s11 });
      e3.id = t5.id, e3.portal = t5.portal;
      const i18 = e3.toJSON();
      await e3.load(), e3.read(i18), await e3.update({ data: r3 });
    } else
      await ((_a = o6.user) == null ? void 0 : _a.addItem({ item: e3, folder: s11, data: r3 }));
    return l9;
  }
  _syncUpInstanceWithItem(e3, t4, r3) {
    S2.prototype.read.call(this, { version: t4.version, authoringApp: t4.authoringApp, authoringAppVersion: t4.authoringAppVersion }, { origin: "web-map", ignoreDefaults: true, url: e3.itemUrl ? L(e3.itemUrl) : void 0 }), i4(r3), this.resourceInfo = t4;
  }
  async _updateItemThumbnail() {
    var _a;
    this.thumbnailUrl && this._isOverridden("thumbnailUrl") && (await ((_a = this.portalItem) == null ? void 0 : _a.updateThumbnail({ thumbnail: this.thumbnailUrl, filename: this._thumbnailFilename })), this._clearThumbnailOverride());
  }
  _getPortalItem(e3) {
    let t4 = x.from(e3);
    return t4.id && (t4 = t4.clone(), t4.id = null), t4.type || (t4.type = ie), t4.portal || (t4.portal = j3.getDefault()), this._validateItemType(t4), t4;
  }
  async _updateFromInternal(e3, t4) {
    if (t4 = t4 || {}, await j2(() => e3.ready), this._updateInitialViewProperties(e3, t4), e3.map === this)
      for (const r3 of e3.allLayerViews)
        "visible" in r3 && "visible" in r3.layer && r3._isOverridden("visible") && (r3.layer.visible = r3.visible), "featureEffect" in r3 && "featureEffect" in r3.layer && r3._isOverridden("featureEffect") && (r3.layer.featureEffect = r3.featureEffect);
    await this._updateThumbnailUrl(e3, t4);
  }
  _updateInitialViewProperties(e3, t4) {
    var _a, _b;
    if (t4.backgroundExcluded || (this.initialViewProperties.background = (_a = e3.background) == null ? void 0 : _a.clone()), this.initialViewProperties.spatialReference = (_b = e3.spatialReference) == null ? void 0 : _b.clone(), t4.viewpointExcluded || (this.initialViewProperties.viewpoint = new l4({ rotation: e3.rotation, scale: t4.scalePreserved ? e3.scale : null, targetGeometry: this._getViewExtent(e3) })), !t4.widgetsExcluded)
      for (const r3 of e3.persistableViewModels)
        r3.updateWebDocument(this);
  }
  _getViewExtent(e3) {
    const t4 = e3.center.clone().normalize(), r3 = e3.extent.clone(), i17 = r3.width / 2;
    return r3.xmin = t4.x - i17, r3.xmax = t4.x + i17, r3;
  }
  async _updateThumbnailUrl(e3, t4) {
    if (t4.thumbnailExcluded)
      return;
    const r3 = i12(e3, t4.thumbnailSize), i17 = await e3.takeScreenshot({ format: "png", width: r3.width, height: r3.height });
    this._setAutoGeneratedThumbnail(i17.dataUrl);
  }
  _setAutoGeneratedThumbnail(e3) {
    this.thumbnailUrl = e3, this._thumbnailFilename = null;
  }
  _clearThumbnailOverride() {
    this._clearOverride("thumbnailUrl"), this.clear("thumbnailUrl", "user"), this._thumbnailFilename = null;
  }
  _generateCustomThumbnailFilename(e3) {
    if (tt(e3)) {
      const t4 = ot(e3), r3 = t4 && t4.mediaType, i17 = r3 && se.get(r3.toLowerCase()) || null, o6 = `thumbnail${Date.now()}`;
      return i17 ? `${o6}.${i17}` : o6;
    }
    return null;
  }
  _getThumbnailState() {
    let e3 = this.thumbnailUrl;
    return e3 && (e3 = this._isOverridden("thumbnailUrl") ? e3 : St(e3, "w", "8192")), { thumbnailUrl: e3, filename: this._thumbnailFilename };
  }
  _restoreThumbnailFromState(e3) {
    this.thumbnailUrl = e3.thumbnailUrl, this._thumbnailFilename = e3.filename;
  }
  _getAuthoringPropsState() {
    return { authoringApp: this.authoringApp, authoringAppVersion: this.authoringAppVersion, isAuthoringAppSetByUser: this._isAuthoringAppSetByUser, isAuthoringAppVersionSetByUser: this._isAuthoringAppVersionSetByUser };
  }
  _restoreAuthoringPropsFromState(e3) {
    e3.isAuthoringAppSetByUser ? this.authoringApp = e3.authoringApp : this._isAuthoringAppSetByUser = false, e3.isAuthoringAppVersionSetByUser ? this.authoringAppVersion = e3.authoringAppVersion : this._isAuthoringAppVersionSetByUser = false;
  }
  static fromJSON(e3) {
    const t4 = e3;
    if (!t4)
      throw new s2("webmap:empty-resource", "Expected a JSON resource but got nothing");
    return new this({ resourceInfo: t4 });
  }
};
Ae.VERSION = re, e([y({ type: c14, json: { write: true } })], Ae.prototype, "applicationProperties", void 0), e([y({ type: String, json: { write: { allowNull: true, ignoreOrigin: true } } })], Ae.prototype, "authoringApp", null), e([r("authoringApp")], Ae.prototype, "writeAuthoringApp", null), e([y({ type: String, json: { write: { allowNull: true, ignoreOrigin: true } } })], Ae.prototype, "authoringAppVersion", null), e([r("authoringAppVersion")], Ae.prototype, "writeAuthoringAppVersion", null), e([y({ json: { read: { source: "baseMap" }, write: { target: "baseMap" } } })], Ae.prototype, "basemap", void 0), e([y({ type: oe, json: { write: { overridePolicy: (e3) => ({ enabled: !!(e3 && e3.length > 0), ignoreOrigin: true }) } } })], Ae.prototype, "bookmarks", void 0), e([y({ type: l5, json: { read: { source: "mapFloorInfo" }, write: { target: "mapFloorInfo" } } })], Ae.prototype, "floorInfo", void 0), e([y({ type: i10, json: { write: true } })], Ae.prototype, "geotriggersInfo", void 0), e([y({ type: m8, nonNullable: true, json: { read: { source: ["background", "initialState.viewpoint", "mapRangeInfo", "spatialReference"] }, write: { ignoreOrigin: true, target: { background: { type: m3 }, "initialState.viewpoint": { type: l4 }, mapRangeInfo: { type: c7 }, spatialReference: { type: f } } } } })], Ae.prototype, "initialViewProperties", void 0), e([o2("initialViewProperties")], Ae.prototype, "readInitialViewProperties", null), e([r("initialViewProperties")], Ae.prototype, "writeInitialViewProperties", null), e([y({ json: { read: false, write: { target: "operationalLayers", ignoreOrigin: true } } })], Ae.prototype, "layers", void 0), e([r("layers")], Ae.prototype, "writeLayers", null), e([y({ type: x })], Ae.prototype, "portalItem", void 0), e([y({ json: { write: true } })], Ae.prototype, "presentation", void 0), e([y()], Ae.prototype, "resourceInfo", void 0), e([y({ readOnly: true, type: s10, json: { read: { source: "version" }, write: { allowNull: true, ignoreOrigin: true, target: "version", isRequired: true } } })], Ae.prototype, "sourceVersion", void 0), e([o2("sourceVersion")], Ae.prototype, "readSourceVersion", null), e([r("sourceVersion")], Ae.prototype, "writeSourceVersion", null), e([y({ json: { read: false, write: { ignoreOrigin: true } } })], Ae.prototype, "tables", void 0), e([r("tables")], Ae.prototype, "writeTables", null), e([y()], Ae.prototype, "thumbnailUrl", null), e([y({ type: n7, json: { write: true } })], Ae.prototype, "widgets", void 0), e([y({ type: ae, json: { read: true, write: true } })], Ae.prototype, "utilityNetworks", void 0), Ae = e([a2("esri.WebMap")], Ae);
var Ie = Ae;
export {
  Ie as default
};
//# sourceMappingURL=@arcgis_core_WebMap.js.map
